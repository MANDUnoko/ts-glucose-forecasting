# 시계열 데이터를 활용한 혈당 변화 예측 모델

---

## 목적

단일 당뇨병 환자의 혈당 시계열 데이터를 기반으로, 식사 및 인슐린 투여 시점을 예측할 수 있는 모델을 설계하고 비교 평가

- 예측 대상: 혈당 수치 (Glucose)
- 데이터: 시계열 구조 / 불규칙 수집 간격 / 외생변수 존재
- 목적: 혈당 예측 정확도 향상을 통해 의료 의사결정지원에 활용 가능성 평가

---

## 데이터 특성 및 전처리

- `30분 간격 리샘플링` + `spline 보간`을 통해 데이터 간격 통일
- `meal_status`, `hypoglycemia` 등 범주형 변수 → one-hot encoding
- 인슐린 3종(Regular/NPH/UltraLente) → `shift lag 변수`로 생성 (작용 시간 기반)
- ADF Test 통해 **정상성 확보 (p < 0.05)** → 1차 차분 (d=1) 적용
- ACF/PACF 분석으로 **(p=2, q=1)** 설정
- STL 분해 통해 하루 단위 **계절성(Seasonality)** 확인 → SARIMAX에 `seasonal_order=(1,0,1,24)` 반영

---

## 모델링 및 평가
| 모델 | RMSE | MAE | 특이사항 |
|------|------|-----|----------|
| **SARIMAX** | **41.61** | **33.81** | 외생변수 포함, 예측 정확도 가장 우수 |
| Random Forest | 50.80 | 40.67 | 시차 피처 기반 비시계열 회귀 |
| VARMAX | 49.13 | 40.69 | 다변량 시계열, 과적합 경향 있음 |

> 모델 평가는 `TimeSeriesSplit(n_splits=5)`을 적용하여 시계열 순서를 보존한 상태로 검증 수행하였습니다.

---

## 주요 인사이트

- **식사 상태**와 **인슐린 투여 시점**은 혈당 변화에 유의미한 영향을 주며, 모델 입력에 포함할 경우 예측 성능이 크게 향상됨.
- **정상성 확보, 계절성 추정, 시차 반영**의 조합이 시계열 예측 정확도에 핵심적으로 기여

---

## 향후 확장 방향

- 멀티환자 시계열 적용 가능성 실험
- Transformer 기반 시계열 예측 모델 비교
- 실제 식단/투약 로그 연동 후 임상 예측 실험 검토



